## NgRx の基本的なデータフロー

### 1. 事前定義

アプリケーション構築時に、以下の要素を定義します：

- Actions: アプリケーション内で発生し得るイベントの種類
- Reducers: 各アクションに対してどのように状態を変更するかのロジック
- Effects: 外部システムとの連携や副作用を処理するロジック
- Selectors: 状態から必要なデータを取り出す方法

### 2. Action の実行（Dispatch）

ユーザー操作などのイベントが発生すると、対応する Action がコンポーネントから dispatch されます。これがデータフローの起点となります。

### 3. Effect 検知による動作

Effect は dispatch されたアクションを監視し、該当するアクションを検知すると、API リクエストなどの副作用処理を実行します。処理結果に基づいて新たなアクション（成功または失敗）を dispatch します。

### 4. Reducer による状態書き換え

Reducer は元のアクションと Effect から発行された新たなアクションを受け取り、現在の状態と合わせて純粋関数として処理します。この際、元の状態は変更せず、新しい状態オブジェクトを生成します。

### 5. State に履歴を残す

不変性（Immutability）の原則により、状態が更新されるたびに新しい状態オブジェクトが生成されるため、各時点の状態の履歴が自然と保持されます。これによりデバッグや状態の追跡が容易になります。

### 6. Selector で実データを取得する

コンポーネントは Selector を使用して、更新された状態から必要なデータを取得します。Selector は状態から特定のデータを抽出する関数で、メモ化（memoization）により、必要な場合のみ再計算が行われ、パフォーマンスが最適化されます。

### 7. UI の更新

取得したデータを基に UI が更新され、ユーザーに新しい状態が表示されます。

この一方向のデータフローにより、NgRx はアプリケーションの状態管理を予測可能で追跡可能なものにします。特に大規模なアプリケーションにおいて、この明確なフローと責任分担が複雑性を軽減し、保守性を高めます。
